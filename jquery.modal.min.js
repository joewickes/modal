!function(a){"use strict";var b=function(b,c){this.settings=c,this.$selector=b,this.$container=a(this.settings.container),this.$modal=a("."+this.settings.modalName,this.$container),this.$modalInside=a("."+this.settings.modalContentName,this.$container),this.$overlay=a("."+this.settings.overlayName,this.$container),this.$loader=a("."+this.settings.loaderName,this.$container),this.settings.autoOpen||!this.$selector?this.show():a(this.$selector).off("click.modal").on("click.modal",a.proxy(this.show,this))};b.prototype.events=function(){a(window).on("resize.modal scroll.modal",a.proxy(this.adjustModal,this)),a(document).on("updateModal.modal ajaxComplete.modal",a.proxy(this.adjustModal,this)),a(document).on("keydown.modal closeModal.modal",a.proxy(this.close,this)),this.$modal.off("click.modal").on("click.modal","."+this.settings.closeModalName,a.proxy(this.close,this)),this.$overlay.off("click.modal").on("click.modal",a.proxy(this.close,this))},b.prototype.show=function(b){"object"==typeof b&&(b.preventDefault(),b.stopPropagation()),this.appendMarkup(),this.settings.modalContent?(this.$modalInside.empty().append(this.settings.modalContent),this.afterLoad()):this.ajax&&"string"==typeof this.settings.ajax.url?this.load(this.settings.ajax.url):this.load(a(this.$selector).attr("href")),this.settings.allowClose?a("."+this.settings.closeModalName,this.$modal).show():a("."+this.settings.closeModalName,this.$modal).hide(),this.settings.afterInit.call(this,a(this.$selector))},b.prototype.close=function(b){var c,d,e="object"==typeof b&&"undefined"!=typeof b.type?b.type:!1,f="keydown"===e||"keyup"===e||"keypress"===e?!0:!1;if("object"==typeof b){if(f&&27!==b.keyCode||b.altKey||b.ctrlKey||b.metaKey||b.shiftKey)return;b.preventDefault(),b.stopPropagation()}a("."+this.settings.modalName).length&&(this.settings.onBeforeClose.call(this,a(this.$selector)),(this.settings.allowClose||"closeModal"===e||"ajaxComplete"===e)&&this.$modal.length&&(c=this.$modal,d=this.$overlay,c.animate({opacity:"hide"},this.settings.animSpeed),d.animate({opacity:"hide"},this.settings.animSpeed,a.proxy(function(){c.remove(),d.remove(),a("."+this.settings.closeModalName,c).off(".modal"),c.off(".modal"),d.off(".modal"),a(".ok-modal").length||(a(window).off(".modal"),a(document).off(".modal"))},this)),this.settings.afterClose.call(this,a(this.$selector))))},b.prototype.load=function(b){var c=this,d=a.extend({},this.settings.ajax);this.$modal.addClass("loading"),this.$modal.is(":hidden")&&(this.$modal.hide().animate({opacity:"show"},this.settings.animSpeed),this.$loader.animate({opacity:"show"},this.settings.animSpeed),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)),d.success=function(b,d,e){c.$loader.animate({opacity:"hide"},c.settings.animSpeed,function(){c.settings.centered||c.$modal.css({marginTop:-c.$modal.height()}).hide().animate({opacity:"show",marginTop:c.settings.centeredOffset},c.settings.animSpeed+100,a.proxy(c.adjustModal,c)),c.$modalInside.empty().append(a(b)).hide().animate({opacity:"show"},c.settings.animSpeed),c.afterLoad("ajaxLoad"),c.settings.afterAjaxSuccess.call(c,b,e)})},d.error=function(a,b,d){c.$loader.animate({opacity:"hide"},c.settings.animSpeed,function(){c.settings.afterAjaxError.call(c,a,d),c.close()})},d.complete=function(a,b){c.$modal.removeClass("loading"),c.settings.afterAjaxComplete.call(c,a)},a.ajax(d)},b.prototype.afterLoad=function(b){this.$modal.is(":hidden")?this.settings.centered?(this.$modal.hide().animate({opacity:"show"},this.settings.animSpeed,a.proxy(this.events,this)),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)):(this.$modal.css({marginTop:-this.$modal.height()}),this.$modal.hide().animate({opacity:"show",marginTop:this.settings.centeredOffset},this.settings.animSpeed,a.proxy(this.events,this)),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)):this.events(),this.adjustModal(),this.$modal.find("[autofocus]").focus(),this.settings.afterLoad.call(this,a(this.$selector)),this.settings.afterOpen.call(this,a(this.$selector))},b.prototype.adjustModal=function(){if(this.$modal.length&&this.$modalInside.length){var b,c,d,e=a(window).height(),f=a(window).width(),g=!1,h=this.settings.centered?0:this.settings.centeredOffset;d=this.$modalInside.outerWidth(),c=this.$modal.outerHeight(),c=this.settings.centered?this.$modal.outerHeight():this.$modal.outerHeight()+2*h,e>c&&f>d?(g=parseInt(this.$modal.css("marginTop")),a.isNumeric(g)&&(g=Math.abs(g)),"body"===this.settings.container&&this.$modal.removeClass("static").addClass("fixed"),this.settings.centered?g!==c/2&&this.$modal.addClass("centered fixed").removeClass("static").css({top:"50%",marginTop:-c/2,marginBottom:0}):this.$modal.removeClass("centered static").addClass("fixed").css({top:0,marginTop:h,marginBottom:h})):this.$modal.hasClass("static")||(b=a(window).scrollTop()-this.$container.offset().top,b=50>b&&0===h?0:b+h,this.$modal.removeClass("centered fixed").addClass("static").css({top:0,marginTop:b}))}},b.prototype.appendMarkup=function(){var b=a("."+this.settings.modalName,this.$container),c=(a("."+this.settings.modalContentName,this.$container),a('<div class="'+this.settings.overlayName+" modal-"+this.settings.modalSkin+'"></div><div class="'+this.settings.modalName+" modal-"+this.settings.modalSkin+'"><div class="'+this.settings.loaderName+'"></div><div class="'+this.settings.modalContentName+'"></div></div>'));this.$container.css({position:"relative"}),this.settings.allowClose||a("."+this.settings.modalName,c).addClass("no-close"),"body"===this.settings.container&&c.addClass("fixed"),b.length?(this.$modal.remove(),this.$overlay.remove(),this.$container.append(c)):this.$container.append(c),this.$modal=a("."+this.settings.modalName,this.$container),this.$modalInside=a("."+this.settings.modalContentName,this.$container),this.$overlay=a("."+this.settings.overlayName,this.$container),this.$loader=a("."+this.settings.loaderName,this.$container),this.settings.modalWidth&&this.$modalInside.css({"max-width":this.settings.modalWidth})},a.fn.modal=function(c){return"object"==typeof c||"undefined"==typeof c?this.each(function(){var d=a.extend(!0,{},a.fn.modal.defaults,c),e=new b(this,d);return a(this).data("modal",e),this}):"string"==typeof c?this.each(function(){var b=a(this).data("modal");return"object"==typeof b&&("adjust"===c&&a.isFunction(b.adjustModal)?b.adjustModal():"close"===c&&a.isFunction(b.close)&&b.close()),this}):void 0},a.modal=function(c){if("object"==typeof c||"undefined"==typeof c){var d=a.extend(!0,{},a.fn.modal.defaults,c),e=new b(!1,d);a(document).data("modal",e)}else if("string"==typeof c){var f=a(document).data("modal");"object"==typeof f&&("adjust"===c&&a.isFunction(f.adjustModal)?f.adjustModal():"close"===c&&a.isFunction(f.close)&&f.close())}},a.fn.modal.defaults={modalName:"modal",modalContentName:"modal-dialog",loaderName:"modal-loader",overlayName:"modal-overlay",closeModalName:"close-modal",loadInsideName:"load-inside",modalSkin:"default",container:"body",centered:!0,centeredOffset:50,fixed:!0,animSpeed:150,modalWidth:800,modalContent:!1,autoOpen:!1,allowClose:!0,closeOnDocumentClick:!0,ajax:!1,afterInit:a.noop,afterOpen:a.noop,afterClose:a.noop,afterLoad:a.noop,afterAjaxSuccess:a.noop,afterAjaxComplete:a.noop,afterAjaxError:a.noop,onBeforeClose:a.noop}}(jQuery);