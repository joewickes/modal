!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e=function(e,s){this.settings=s,this.$selector=e,this.$container=t(this.settings.container),this.$modal=t("."+this.settings.modalName,this.$container),this.$modalInside=t("."+this.settings.modalContentName,this.$container),this.$overlay=t("."+this.settings.overlayName,this.$container),this.$loader=t("."+this.settings.loaderName,this.$container),this.settings.autoOpen||!this.$selector?this.show():t(this.$selector).off("click.modal").on("click.modal",t.proxy(this.show,this))};e.prototype.events=function(){t(window).on("resize.modal scroll.modal",t.proxy(this.adjustModal,this)),t(document).on("updateModal.modal ajaxComplete.modal",t.proxy(this.adjustModal,this)),t(document).on("keydown.modal closeModal.modal",t.proxy(this.close,this)),this.$modal.off("click.modal").on("click.modal","."+this.settings.closeModalName,t.proxy(this.close,this)),this.$overlay.off("click.modal").on("click.modal",t.proxy(this.close,this))},e.prototype.show=function(e){"object"==typeof e&&(e.preventDefault(),e.stopPropagation()),this.appendMarkup(),this.settings.modalContent?(this.$modalInside.empty().append(this.settings.modalContent),this.afterLoad()):this.ajax&&"string"==typeof this.settings.ajax.url?this.load(this.settings.ajax.url):this.load(t(this.$selector).attr("href")),this.settings.allowClose?t("."+this.settings.closeModalName,this.$modal).show():t("."+this.settings.closeModalName,this.$modal).hide(),this.settings.afterInit.call(this,t(this.$selector))},e.prototype.close=function(e){var s,i,o="object"==typeof e&&void 0!==e.type&&e.type;if("object"==typeof e){if(("keydown"===o||"keyup"===o||"keypress"===o)&&27!==e.keyCode||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;e.preventDefault(),e.stopPropagation()}t("."+this.settings.modalName).length&&(this.settings.onBeforeClose.call(this,t(this.$selector)),(this.settings.allowClose||"closeModal"===o||"ajaxComplete"===o)&&this.$modal.length&&(s=this.$modal,i=this.$overlay,s.animate({opacity:"hide"},this.settings.animSpeed),i.animate({opacity:"hide"},this.settings.animSpeed,t.proxy(function(){s.remove(),i.remove(),t("."+this.settings.closeModalName,s).off(".modal"),s.off(".modal"),i.off(".modal"),t(".ok-modal").length||(t(window).off(".modal"),t(document).off(".modal"))},this)),this.settings.afterClose.call(this,t(this.$selector))))},e.prototype.load=function(e){var s=this,i=t.extend({},this.settings.ajax);this.$modal.addClass("loading"),this.$modal.is(":hidden")&&(this.$modal.hide().animate({opacity:"show"},this.settings.animSpeed),this.$loader.animate({opacity:"show"},this.settings.animSpeed),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)),i.success=function(e,i,o){s.$loader.animate({opacity:"hide"},s.settings.animSpeed,function(){s.settings.centered||s.$modal.css({marginTop:-s.$modal.height()}).hide().animate({opacity:"show",marginTop:0},s.settings.animSpeed+100,t.proxy(s.adjustModal,s)),s.$modalInside.empty().append(t(e)).hide().animate({opacity:"show"},s.settings.animSpeed),s.afterLoad("ajaxLoad"),s.settings.afterAjaxSuccess.call(s,e,o)})},i.error=function(t,e,i){s.$loader.animate({opacity:"hide"},s.settings.animSpeed,function(){s.settings.afterAjaxError.call(s,t,i),s.close()})},i.complete=function(t,e){s.$modal.removeClass("loading"),s.settings.afterAjaxComplete.call(s,t)},t.ajax(i)},e.prototype.afterLoad=function(e){this.$modal.is(":hidden")?this.settings.centered?(this.$modal.hide().animate({opacity:"show"},this.settings.animSpeed,t.proxy(this.events,this)),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)):(this.$modal.css({marginTop:-this.$modal.height()}),this.$modal.hide().animate({opacity:"show",marginTop:0},this.settings.animSpeed,t.proxy(this.events,this)),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)):this.events(),this.adjustModal(),this.$modal.find("[autofocus]").focus(),this.settings.afterLoad.call(this,t(this.$selector)),this.settings.afterOpen.call(this,t(this.$selector))},e.prototype.adjustModal=function(){if(this.$modal.length&&this.$modalInside.length){var e,s,i,o=t(window).height(),a=t(window).width(),n=!1;i=this.$modalInside.outerWidth(),(s=this.$modal.outerHeight())<o&&a>i?(n=parseInt(this.$modal.css("marginTop")),t.isNumeric(n)&&(n=Math.abs(n)),"body"===this.settings.container&&this.$modal.removeClass("static").addClass("fixed"),this.settings.centered?n!==s/2&&this.$modal.addClass("centered fixed").removeClass("static").css({top:"50%",marginTop:-s/2,marginBottom:0}):this.$modal.removeClass("centered static").addClass("fixed").css({top:0})):this.$modal.hasClass("static")||(e=(e=t(window).scrollTop()-this.$container.offset().top)<50?0:e+0,this.$modal.removeClass("centered fixed").addClass("static").css({top:0,marginTop:e}))}},e.prototype.appendMarkup=function(){var e=t("."+this.settings.modalName,this.$container),s=(t("."+this.settings.modalContentName,this.$container),t('<div class="'+this.settings.overlayName+" modal-"+this.settings.modalSkin+'"></div><div class="'+this.settings.modalName+" modal-"+this.settings.modalSkin+'"><div class="'+this.settings.loaderName+'"></div><div class="'+this.settings.modalContentName+'"></div></div>'));this.$container.css({position:"relative"}),this.settings.centered||this.$modal.css({marginTop:-this.$modal.height()}),this.settings.allowClose||t("."+this.settings.modalName,s).addClass("no-close"),"body"===this.settings.container&&s.addClass("fixed"),e.length?(this.$modal.remove(),this.$overlay.remove(),this.$container.append(s)):this.$container.append(s),this.$modal=t("."+this.settings.modalName,this.$container),this.$modalInside=t("."+this.settings.modalContentName,this.$container),this.$overlay=t("."+this.settings.overlayName,this.$container),this.$loader=t("."+this.settings.loaderName,this.$container),this.settings.modalWidth&&this.$modalInside.css({"max-width":this.settings.modalWidth})},t.fn.modal=function(s){return"object"==typeof s||void 0===s?this.each(function(){var i=t.extend(!0,{},t.fn.modal.defaults,s),o=new e(this,i);return t(this).data("modal",o),this}):"string"==typeof s?this.each(function(){var e=t(this).data("modal");return"object"==typeof e&&("adjust"===s&&t.isFunction(e.adjustModal)?e.adjustModal():"close"===s&&t.isFunction(e.close)&&e.close()),this}):void 0},t.modal=function(s){if("object"==typeof s||void 0===s){var i=t.extend(!0,{},t.fn.modal.defaults,s),o=new e(!1,i);t(document).data("modal",o)}else if("string"==typeof s){var a=t(document).data("modal");"object"==typeof a&&("adjust"===s&&t.isFunction(a.adjustModal)?a.adjustModal():"close"===s&&t.isFunction(a.close)&&a.close())}},t.fn.modal.defaults={modalName:"modal",modalContentName:"modal-dialog",loaderName:"modal-loader",overlayName:"modal-overlay",closeModalName:"close-modal",loadInsideName:"load-inside",modalSkin:"default",container:"body",centered:!0,fixed:!0,animSpeed:150,modalWidth:800,modalContent:!1,autoOpen:!1,allowClose:!0,closeOnDocumentClick:!0,ajax:!1,afterInit:t.noop,afterOpen:t.noop,afterClose:t.noop,afterLoad:t.noop,afterAjaxSuccess:t.noop,afterAjaxComplete:t.noop,afterAjaxError:t.noop,onBeforeClose:t.noop}});