!function(t){"object"==typeof exports?module.exports=t(jQuery):t(jQuery)}(function(t){"use strict";var s=function(s,e){this.settings=e,this.$selector=s,this.$container=t(this.settings.container),this.$modal=t("."+this.settings.modalName,this.$container),this.$modalInside=t("."+this.settings.modalContentName,this.$container),this.$overlay=t("."+this.settings.overlayName,this.$container),this.$loader=t("."+this.settings.loaderName,this.$container),this.settings.autoOpen||!this.$selector?this.show():t(this.$selector).off("click.modal").on("click.modal",t.proxy(this.show,this))};s.prototype.events=function(){t(window).on("resize.modal scroll.modal",t.proxy(this.adjustModal,this)),t(document).on("updateModal.modal ajaxComplete.modal",t.proxy(this.adjustModal,this)),t(document).on("keydown.modal closeModal.modal",t.proxy(this.close,this)),this.$modal.off("click.modal").on("click.modal","."+this.settings.closeModalName,t.proxy(this.close,this)),this.$overlay.off("click.modal").on("click.modal",t.proxy(this.close,this))},s.prototype.show=function(s){"object"==typeof s&&(s.preventDefault(),s.stopPropagation()),this.appendMarkup(),this.settings.modalContent?(this.$modalInside.empty().append(this.settings.modalContent),this.afterLoad()):this.ajax&&"string"==typeof this.settings.ajax.url?this.load(this.settings.ajax.url):this.load(t(this.$selector).attr("href")),this.settings.allowClose?t("."+this.settings.closeModalName,this.$modal).show():t("."+this.settings.closeModalName,this.$modal).hide(),t("body").addClass("modal-open"),this.settings.afterInit.call(this,t(this.$selector))},s.prototype.close=function(s){var e,o,i="object"==typeof s&&void 0!==s.type&&s.type;if("object"==typeof s){if(("keydown"===i||"keyup"===i||"keypress"===i)&&27!==s.keyCode||s.altKey||s.ctrlKey||s.metaKey||s.shiftKey)return;s.preventDefault(),s.stopPropagation()}t("."+this.settings.modalName).length&&(this.settings.onBeforeClose.call(this,t(this.$selector)),(this.settings.allowClose||"closeModal"===i||"ajaxComplete"===i)&&this.$modal.length&&(e=this.$modal,o=this.$overlay,e.animate({opacity:"hide"},this.settings.animSpeed),o.animate({opacity:"hide"},this.settings.animSpeed,t.proxy(function(){e.remove(),o.remove(),t("."+this.settings.closeModalName,e).off(".modal"),e.off(".modal"),o.off(".modal"),t(".ok-modal").length||(t(window).off(".modal"),t(document).off(".modal"))},this)),t("body").removeClass("modal-open"),this.settings.afterClose.call(this,t(this.$selector))))},s.prototype.load=function(s){var e=this,o=t.extend({},this.settings.ajax);this.$modal.addClass("loading"),this.$modal.is(":hidden")&&(this.$modal.hide().animate({opacity:"show"},this.settings.animSpeed),this.$loader.animate({opacity:"show"},this.settings.animSpeed),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)),o.success=function(s,o,i){e.$loader.animate({opacity:"hide"},e.settings.animSpeed,function(){e.settings.centered||e.$modal.css({marginTop:-e.$modal.height()}).hide().animate({opacity:"show",marginTop:0},e.settings.animSpeed+100,t.proxy(e.adjustModal,e)),e.$modalInside.empty().append(t(s)).hide().animate({opacity:"show"},e.settings.animSpeed),e.afterLoad("ajaxLoad"),e.settings.afterAjaxSuccess.call(e,s,i)})},o.error=function(t,s,o){e.$loader.animate({opacity:"hide"},e.settings.animSpeed,function(){e.settings.afterAjaxError.call(e,t,o),e.close()})},o.complete=function(t,s){e.$modal.removeClass("loading"),e.settings.afterAjaxComplete.call(e,t)},t.ajax(o)},s.prototype.afterLoad=function(s){this.$modal.is(":hidden")?this.settings.centered?(this.$modal.hide().animate({opacity:"show"},this.settings.animSpeed,t.proxy(this.events,this)),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)):(this.$modal.css({marginTop:-this.$modal.height()}),this.$modal.hide().animate({opacity:"show",marginTop:0},this.settings.animSpeed,t.proxy(this.events,this)),this.$overlay.hide().animate({opacity:"show"},this.settings.animSpeed)):this.events(),this.adjustModal(),this.$modal.find("[autofocus]").focus(),this.settings.afterLoad.call(this,t(this.$selector)),this.settings.afterOpen.call(this,t(this.$selector))},s.prototype.adjustModal=function(){if(this.$modal.length&&this.$modalInside.length){var s,e,o,i=t(window).height(),a=t(window).width(),n=!1;o=this.$modalInside.outerWidth(),(e=this.$modal.outerHeight())<i&&a>o?(n=parseInt(this.$modal.css("marginTop")),t.isNumeric(n)&&(n=Math.abs(n)),"body"===this.settings.container&&this.$modal.removeClass("static").addClass("fixed"),this.settings.centered?n!==e/2&&this.$modal.addClass("centered fixed").removeClass("static").css({top:"50%",marginTop:-e/2,marginBottom:0}):this.$modal.removeClass("centered static").addClass("fixed").css({top:0})):this.$modal.hasClass("static")||(s=(s=t(window).scrollTop()-this.$container.offset().top)<50?0:s+0,this.$modal.removeClass("centered fixed").addClass("static").css({top:0,marginTop:s}))}},s.prototype.appendMarkup=function(){var s=t("."+this.settings.modalName,this.$container),e=(t("."+this.settings.modalContentName,this.$container),t('<div class="'+this.settings.overlayName+" modal-"+this.settings.modalSkin+'"></div><div class="'+this.settings.modalName+" modal-"+this.settings.modalSkin+'"><div class="'+this.settings.loaderName+'"></div><div class="'+this.settings.modalContentName+'"></div></div>'));this.$container.css({position:"relative"}),this.settings.centered||this.$modal.css({marginTop:-this.$modal.height()}),this.settings.allowClose||t("."+this.settings.modalName,e).addClass("no-close"),"body"===this.settings.container&&e.addClass("fixed"),s.length?(this.$modal.remove(),this.$overlay.remove(),this.$container.append(e)):this.$container.append(e),this.$modal=t("."+this.settings.modalName,this.$container),this.$modalInside=t("."+this.settings.modalContentName,this.$container),this.$overlay=t("."+this.settings.overlayName,this.$container),this.$loader=t("."+this.settings.loaderName,this.$container),this.settings.modalWidth&&this.$modalInside.css({"max-width":this.settings.modalWidth})},t.fn.modal2=function(e){return"object"==typeof e||void 0===e?this.each(function(){var o=t.extend(!0,{},t.fn.modal2.defaults,e),i=new s(this,o);return t(this).data("modal",i),this}):"string"==typeof e?this.each(function(){var s=t(this).data("modal");return"object"==typeof s&&("adjust"===e&&t.isFunction(s.adjustModal)?s.adjustModal():"close"===e&&t.isFunction(s.close)&&s.close()),this}):void 0},t.modal2=function(e){if("object"==typeof e||void 0===e){var o=t.extend(!0,{},t.fn.modal2.defaults,e),i=new s(!1,o);t(document).data("modal",i)}else if("string"==typeof e){var a=t(document).data("modal");"object"==typeof a&&("adjust"===e&&t.isFunction(a.adjustModal)?a.adjustModal():"close"===e&&t.isFunction(a.close)&&a.close())}},t.fn.modal2.defaults={modalName:"modal-window",modalContentName:"modal-container",loaderName:"modal-loader",overlayName:"modal-overlay",closeModalName:"close-modal",loadInsideName:"load-inside",modalSkin:"default",container:"body",centered:!0,fixed:!0,animSpeed:150,modalWidth:800,modalContent:!1,autoOpen:!1,allowClose:!0,closeOnDocumentClick:!0,ajax:!1,afterInit:t.noop,afterOpen:t.noop,afterClose:t.noop,afterLoad:t.noop,afterAjaxSuccess:t.noop,afterAjaxComplete:t.noop,afterAjaxError:t.noop,onBeforeClose:t.noop}});